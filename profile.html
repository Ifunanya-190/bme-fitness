<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Profile - BME Fitness</title>
<link rel="stylesheet" href="css/base.css">
<link rel="stylesheet" href="css/auth-enhancements.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
.profile-container {
    max-width: 800px;
    margin: 40px auto;
    padding: 20px;
}

.profile-header {
    background: linear-gradient(135deg, var(--gold), var(--gold-dark));
    color: #000;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    margin-bottom: 30px;
}

.profile-avatar {
    width: 100px;
    height: 100px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    margin: 0 auto 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40px;
}

.profile-info {
    background: var(--card-bg);
    padding: 30px;
    border-radius: 15px;
    margin-bottom: 20px;
    border: 1px solid var(--border);
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.info-item {
    padding: 15px;
    background: var(--bg);
    border-radius: 10px;
    border: 1px solid var(--border);
}

.info-item label {
    display: block;
    color: var(--gold);
    font-weight: 600;
    margin-bottom: 5px;
}

.info-item span {
    color: var(--text);
    font-size: 14px;
}

.edit-profile-btn {
    background: linear-gradient(135deg, var(--gold), var(--gold-dark));
    color: #000;
    border: none;
    padding: 12px 30px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    margin-top: 20px;
    transition: var(--transition-smooth);
}

.edit-profile-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(201, 163, 78, 0.4);
}

/* Light theme support */
body.light-theme .profile-info {
    background: var(--light-card-bg);
    border: 1px solid var(--light-border);
}

body.light-theme .info-item {
    background: var(--light-bg);
    border: 1px solid var(--light-border);
}

body.light-theme .info-item label {
    color: var(--gold);
}

body.light-theme .info-item span {
    color: var(--light-text);
}

@media (max-width: 768px) {
    .profile-container {
        margin: 20px;
        padding: 10px;
    }
    
    .profile-header {
        padding: 20px;
    }
    
    .profile-info {
        padding: 20px;
    }
}
</style>
</head>
<body>

<!-- NAVBAR -->
<header class="navbar">
<div class="container nav-flex">

<div class="logo">BME FITNESS</div>

<div class="menu-toggle" id="menu-toggle">
    â˜°
</div>

<nav class="nav-links" id="nav-links">
<a href="index.html">Home</a>
<a href="about.html">About</a>
<a href="services.html">Training</a>
<a href="pricing.html">Pricing</a>
<a href="transformations.html">Results</a>
<a href="trainers.html">Trainers</a>
<a href="schedule.html">Schedule</a>
<a href="contact.html">Contact</a>
<a href="login.html" class="btn">Sign Up</a>
<a href="https://wa.me/2349012345678?text=I'm%20interested%20in%20BME%20Services" class="whatsapp-nav">WhatsApp</a>
</nav>
</div>
</header>

<section>
<div class="container">
<div class="profile-container">
    <div class="profile-header">
        <div class="profile-avatar">
            <i class="fas fa-user"></i>
        </div>
        <h1 id="profileName">Loading...</h1>
        <p id="profileEmail">Loading...</p>
    </div>

    <div class="profile-info">
        <h2>Profile Information</h2>
        <div class="info-grid">
            <div class="info-item">
                <label>Full Name</label>
                <span id="displayName">Not set</span>
            </div>
            <div class="info-item">
                <label>Email Address</label>
                <span id="email">Not set</span>
            </div>
            <div class="info-item">
                <label>Member Since</label>
                <span id="memberSince">Not set</span>
            </div>
            <div class="info-item">
                <label>User ID</label>
                <span id="userId">Not set</span>
            </div>
            <div class="info-item">
                <label>Membership Status</label>
                <span id="membershipStatus">Free Member</span>
            </div>
            <div class="info-item">
                <label>Last Login</label>
                <span id="lastLogin">Not set</span>
            </div>
        </div>
        <button class="edit-profile-btn" onclick="editProfile()">
            <i class="fas fa-edit"></i> Edit Profile
        </button>
    </div>
</div>
</div>
</section>

<script src="js/menu.js"></script>
<script src="js/theme.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="js/auth.js"></script>

<script>
// Load profile data
document.addEventListener('DOMContentLoaded', function() {
    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            // Update profile header
            document.getElementById('profileName').textContent = user.displayName || 'User';
            document.getElementById('profileEmail').textContent = user.email;
            
            // Update profile info
            document.getElementById('displayName').textContent = user.displayName || 'Not set';
            document.getElementById('email').textContent = user.email;
            document.getElementById('memberSince').textContent = user.metadata.creationTime ? 
                new Date(user.metadata.creationTime).toLocaleDateString() : 'Unknown';
            document.getElementById('userId').textContent = user.uid;
            document.getElementById('membershipStatus').textContent = 'Free Member';
            document.getElementById('lastLogin').textContent = new Date().toLocaleDateString();
        } else {
            // Redirect to login if not authenticated
            window.location.href = 'login.html';
        }
    });
});

function editProfile() {
    const user = firebase.auth().currentUser;
    if (!user) {
        alert('Please sign in first');
        return;
    }
    
    // Create edit form modal
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
    `;
    
    modal.innerHTML = `
        <div style="background: var(--card-bg); padding: 30px; border-radius: 15px; max-width: 400px; width: 90%; border: 1px solid var(--border);">
            <h2 style="margin-bottom: 20px; color: var(--text);">Edit Profile</h2>
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: var(--gold); font-weight: 600;">Display Name</label>
                <input type="text" id="editName" value="${user.displayName || ''}" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 5px; background: var(--bg); color: var(--text);">
            </div>
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 5px; color: var(--gold); font-weight: 600;">Email</label>
                <input type="email" value="${user.email}" disabled style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 5px; background: var(--bg); color: var(--text-secondary);">
            </div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="closeProfileModal()" style="padding: 10px 20px; border: 1px solid var(--border); background: var(--bg); color: var(--text); border-radius: 5px; cursor: pointer;">Cancel</button>
                <button onclick="saveProfile()" style="padding: 10px 20px; background: linear-gradient(135deg, var(--gold), var(--gold-dark)); color: #000; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">Save</button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Add event listener to close modal when clicking outside
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            closeProfileModal();
        }
    });
}

function closeProfileModal() {
    const modal = document.querySelector('div[style*="position: fixed"]');
    if (modal) {
        modal.remove();
    }
}

function saveProfile() {
    const user = firebase.auth().currentUser;
    const newName = document.getElementById('editName').value.trim();
    
    if (!newName) {
        alert('Please enter a name');
        return;
    }
    
    // Update profile
    user.updateProfile({
        displayName: newName
    }).then(() => {
        // Update display
        document.getElementById('profileName').textContent = newName;
        document.getElementById('displayName').textContent = newName;
        
        // Close modal
        closeProfileModal();
        
        alert('Profile updated successfully!');
    }).catch((error) => {
        alert('Error updating profile: ' + error.message);
    });
}
</script>

</body>
</html>
